require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(c){"use strict";var d,e="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,f="undefined"!=typeof window?window.Backbone:"undefined"!=typeof c?c.Backbone:null,g=a("cue").settings(),h=a("../models/track"),i="undefined"!=typeof window?window.wp:"undefined"!=typeof c?c.wp:null;d=f.Collection.extend({model:h,comparator:function(a){return parseInt(a.get("order"),10)},fetch:function(){var a=this;return i.ajax.post("cue_get_playlist",{post_id:g.postId}).done(function(b){a.reset(b)})},save:function(a){return this.sort(),a=e.extend({},a,{post_id:g.postId,tracks:this.toJSON(),nonce:g.saveNonce}),i.ajax.post("cue_save_playlist_tracks",a)}}),b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../models/track":2,cue:"cue"}],2:[function(a,b,c){(function(a){"use strict";var c,d="undefined"!=typeof window?window.Backbone:"undefined"!=typeof a?a.Backbone:null;c=d.Model.extend({defaults:{artist:"",artworkId:"",artworkUrl:"",audioId:"",audioUrl:"",format:"",length:"",title:"",order:0}}),b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(a,b,c){(function(c){"use strict";var d,e="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,f=a("cue"),g=a("cue").l10n,h=a("../views/media-frame"),i="undefined"!=typeof window?window.wp:"undefined"!=typeof c?c.wp:null,j=i.media.model.Attachment;d={frames:[],model:{},setModel:function(a){return this.model=a,this},get:function(a){var b="_"+a,c=this.frames[b]||null;return c=this[b].call(this,c),this.frames[b]=c,c},_addTracks:function(a){return a?a:(a=new h({title:g.workflows.addTracks.frameTitle,library:{type:"audio"},button:{text:g.workflows.addTracks.frameButtonText},multiple:"add"}),a.uploader.options.uploader.plupload={filters:{mime_types:[{title:g.workflows.addTracks.fileTypes,extensions:"m4a,mp3,ogg,wma"}]}},a.state("embed").props.off("change:url",a.state("embed").debouncedScan),a.state("insert").on("insert",function(a){e.each(a.models,function(a){f.tracks.push(a.toJSON().cue)})}),a.state("embed").on("select",function(){var a=this.props.toJSON(),b={audioId:"",audioUrl:a.url};"title"in a&&""!==a.title&&(b.title=a.title),f.tracks.push(b)}),a)},_selectArtwork:function(a){var b=this;return a?a:(a=i.media({title:g.workflows.selectArtwork.frameTitle,library:{type:"image"},button:{text:g.workflows.selectArtwork.frameButtonText},multiple:!1}),a.uploader.options.uploader.plupload={filters:{mime_types:[{files:g.workflows.selectArtwork.fileTypes,extensions:"jpg,jpeg,gif,png"}]}},a.on("open",function(){var a=this.get("library").get("selection"),c=b.model.get("artworkId"),d=[];c&&(d.push(j.get(c)),d[0].fetch()),a.reset(d)}),a.state("library").on("select",function(){var a=this.get("selection").first().toJSON();b.model.set({artworkId:a.id,artworkUrl:a.sizes.cue.url})}),a)},_selectAudio:function(a){var b=this;return a?a:(a=new h({title:g.workflows.selectAudio.frameTitle,library:{type:"audio"},button:{text:g.workflows.selectAudio.frameButtonText},multiple:!1}),a.uploader.options.uploader.plupload={filters:{mime_types:[{title:g.workflows.selectAudio.fileTypes,extensions:"m4a,mp3,ogg,wma"}]}},a.state("embed").props.off("change:url",a.state("embed").debouncedScan),a.on("open",function(){var c=this.get("insert").get("selection"),d=b.model.get("audioId"),e=b.model.get("audioUrl"),f=e&&!d,g=[];d&&(g.push(j.get(d)),g[0].fetch()),c.reset(g),f?this.get("embed").props.set({url:e,title:b.model.get("title")}):this.get("embed").props.set({url:"",title:""}),a.setState(f?"embed":"insert")}),a.state("insert").on("insert",function(a){var c=a.first().toJSON().cue,d={},f=e.keys(b.model.attributes);e.without(f,["id","order"]),e.each(f,function(a){var e=b.model.get(a);!e&&a in c&&e!==c[a]&&(d[a]=c[a])}),d.audioId=c.audioId,d.audioUrl=c.audioUrl,b.model.set(d)}),a.state("embed").on("select",function(){var a=this.props.toJSON(),c={};c.audioId="",c.audioUrl=a.url,"title"in a&&""!==a.title&&(c.title=a.title),b.model.set(c)}),a.on("escape",function(){var a=b.model.toJSON();a.artworkUrl||a.audioUrl||b.model.destroy()}),a)}},b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../views/media-frame":6,cue:"cue"}],4:[function(a,b,c){(function(b){"use strict";var c="undefined"!=typeof window?window.jQuery:"undefined"!=typeof b?b.jQuery:null,d=a("cue"),e="undefined"!=typeof window?window.mejs:"undefined"!=typeof b?b.mejs:null,f="undefined"!=typeof window?window.wp:"undefined"!=typeof b?b.wp:null;d.data=_cueSettings,d.settings(_cueSettings),f.media.view.settings.post.id=d.data.postId,f.media.view.settings.defaultProps={},e.plugins.silverlight[0].types.push("audio/x-ms-wma"),d.model.Track=a("./models/track"),d.model.Tracks=a("./collections/tracks"),d.view.MediaFrame=a("./views/media-frame"),d.view.PostForm=a("./views/post-form"),d.view.AddTracksButton=a("./views/button/add-tracks"),d.view.TrackList=a("./views/track-list"),d.view.Track=a("./views/track"),d.view.TrackArtwork=a("./views/track/artwork"),d.view.TrackAudio=a("./views/track/audio"),d.workflows=a("./modules/workflows"),c(function(a){var b;b=d.tracks=new d.model.Tracks(d.data.tracks),delete d.data.tracks,new d.view.PostForm({collection:b,l10n:d.l10n})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./collections/tracks":1,"./models/track":2,"./modules/workflows":3,"./views/button/add-tracks":5,"./views/media-frame":6,"./views/post-form":7,"./views/track":9,"./views/track-list":8,"./views/track/artwork":10,"./views/track/audio":11,cue:"cue"}],5:[function(a,b,c){(function(c){"use strict";var d,e="undefined"!=typeof window?window.jQuery:"undefined"!=typeof c?c.jQuery:null,f=a("../../modules/workflows"),g="undefined"!=typeof window?window.wp:"undefined"!=typeof c?c.wp:null;d=g.Backbone.View.extend({id:"add-tracks",tagName:"p",events:{"click .button":"click"},initialize:function(a){this.l10n=a.l10n},render:function(){var a=e("<a />",{text:this.l10n.addTracks}).addClass("button button-secondary");return this.$el.html(a),this},click:function(a){a.preventDefault(),f.get("addTracks").open()}}),b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../modules/workflows":3}],6:[function(a,b,c){(function(c){"use strict";var d,e="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,f=a("cue").l10n,g="undefined"!=typeof window?window.wp:"undefined"!=typeof c?c.wp:null;d=g.media.view.MediaFrame.Post.extend({createStates:function(){var a=this.options;this.states.add([new g.media.controller.Library({id:"insert",title:this.options.title,priority:20,toolbar:"main-insert",filterable:"uploaded",library:g.media.query(a.library),multiple:a.multiple?"reset":!1,editable:!1,allowLocalEdits:!0,displaySettings:!1,displayUserSettings:!1}),new g.media.controller.Embed({title:f.addFromUrl,menuItem:{text:f.addFromUrl,priority:120},type:"link"})])},bindHandlers:function(){g.media.view.MediaFrame.Select.prototype.bindHandlers.apply(this,arguments),this.on("toolbar:create:main-insert",this.createToolbar,this),this.on("toolbar:create:main-embed",this.mainEmbedToolbar,this);var a={menu:{"default":"mainMenu"},content:{embed:"embedContent","edit-selection":"editSelectionContent"},toolbar:{"main-insert":"mainInsertToolbar"}};e.each(a,function(a,b){e.each(a,function(a,c){this.on(b+":render:"+c,this[a],this)},this)},this)},mainInsertToolbar:function(a){var b=this;this.selectionStatusToolbar(a),a.set("insert",{style:"primary",priority:80,text:b.options.button.text,requires:{selection:!0},click:function(){var a=b.state(),c=a.get("selection");b.close(),a.trigger("insert",c).reset()}})},mainEmbedToolbar:function(a){a.view=new g.media.view.Toolbar.Embed({controller:this,text:this.options.button.text})}}),b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{cue:"cue"}],7:[function(a,b,c){(function(c){"use strict";var d,e="undefined"!=typeof window?window.jQuery:"undefined"!=typeof c?c.jQuery:null,f=a("./button/add-tracks"),g=a("./track-list"),h="undefined"!=typeof window?window.wp:"undefined"!=typeof c?c.wp:null;d=h.Backbone.View.extend({el:"#post",saved:!1,events:{"click #publish":"buttonClick","click #save-post":"buttonClick"},initialize:function(a){this.l10n=a.l10n,this.render()},render:function(){return this.views.add("#cue-playlist-editor .cue-panel-body",[new f({collection:this.collection,l10n:this.l10n}),new g({collection:this.collection})]),this},buttonClick:function(a){var b=this,c=e(a.target);return b.saved||this.collection.save().done(function(a){b.saved=!0,c.click()}),b.saved}}),b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./button/add-tracks":5,"./track-list":8}],8:[function(a,b,c){(function(c){"use strict";var d,e="undefined"!=typeof window?window.jQuery:"undefined"!=typeof c?c.jQuery:null,f="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,g=a("./track"),h="undefined"!=typeof window?window.wp:"undefined"!=typeof c?c.wp:null;d=h.Backbone.View.extend({className:"cue-tracklist",tagName:"ol",initialize:function(){this.listenTo(this.collection,"add",this.addTrack),this.listenTo(this.collection,"add remove",this.updateOrder),this.listenTo(this.collection,"reset",this.render)},render:function(){return this.$el.empty(),this.collection.each(this.addTrack,this),this.updateOrder(),this.$el.sortable({axis:"y",delay:150,forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.6,start:function(a,b){b.placeholder.css("visibility","visible")},update:f.bind(function(a,b){this.updateOrder()},this)}),this},addTrack:function(a){var b=new g({model:a});this.$el.append(b.render().el)},updateOrder:function(){f.each(this.$el.find(".cue-track"),function(a,b){var c=e(a).data("cid");this.collection.get(c).set("order",b)},this)}}),b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./track":9}],9:[function(a,b,c){(function(c){"use strict";var d,e="undefined"!=typeof window?window.jQuery:"undefined"!=typeof c?c.jQuery:null,f=a("./track/artwork"),g=a("./track/audio"),h="undefined"!=typeof window?window.wp:"undefined"!=typeof c?c.wp:null;d=h.Backbone.View.extend({tagName:"li",className:"cue-track",template:h.template("cue-playlist-track"),events:{"change [data-setting]":"updateAttribute","click .js-toggle":"toggleOpenStatus","dblclick .cue-track-title":"toggleOpenStatus","click .js-close":"minimize","click .js-remove":"destroy"},initialize:function(){this.listenTo(this.model,"change:title",this.updateTitle),this.listenTo(this.model,"change",this.updateFields),this.listenTo(this.model,"destroy",this.remove)},render:function(){return this.$el.html(this.template(this.model.toJSON())).data("cid",this.model.cid),this.views.add(".cue-track-column-artwork",new f({model:this.model,parent:this})),this.views.add(".cue-track-audio-group",new g({model:this.model,parent:this})),this},minimize:function(a){a.preventDefault(),this.$el.removeClass("is-open").find("input:focus").blur()},toggleOpenStatus:function(a){a.preventDefault(),this.$el.toggleClass("is-open").find("input:focus").blur(),this.$el.hasClass("is-open")&&e(window).trigger("resize")},updateAttribute:function(a){var b=e(a.target).data("setting"),c=a.target.value;this.model.get(b)!==c&&this.model.set(b,c)},updateFields:function(){var a,b,c=this.model.toJSON(),d=this.$el.find("[data-setting]");for(a in c)b=e("<div/>").html(c[a]).text(),d.filter('[data-setting="'+a+'"]').val(b)},updateTitle:function(){var a=this.model.get("title");this.$el.find(".cue-track-title .text").text(a?a:"Title")},destroy:function(){this.model.trigger("destroy",this.model)},remove:function(){this.$el.remove()}}),b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./track/artwork":10,"./track/audio":11}],10:[function(a,b,c){(function(c){"use strict";var d,e="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,f=a("../../modules/workflows"),g="undefined"!=typeof window?window.wp:"undefined"!=typeof c?c.wp:null;d=g.Backbone.View.extend({tagName:"span",className:"cue-track-artwork",template:g.template("cue-playlist-track-artwork"),events:{click:"select"},initialize:function(a){this.parent=a.parent,this.listenTo(this.model,"change:artworkUrl",this.render)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.parent.$el.toggleClass("has-artwork",!e.isEmpty(this.model.get("artworkUrl"))),this},select:function(){f.setModel(this.model).get("selectArtwork").open()}}),b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../modules/workflows":3}],11:[function(a,b,c){(function(c){"use strict";var d,e="undefined"!=typeof window?window.jQuery:"undefined"!=typeof c?c.jQuery:null,f="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,g="undefined"!=typeof window?window.mejs:"undefined"!=typeof c?c.mejs:null,h=a("cue").settings(),i=a("../../modules/workflows"),j="undefined"!=typeof window?window.wp:"undefined"!=typeof c?c.wp:null;d=j.Backbone.View.extend({tagName:"span",className:"cue-track-audio",template:j.template("cue-playlist-track-audio"),events:{"click .cue-track-audio-selector":"select"},initialize:function(a){this.parent=a.parent,this.listenTo(this.model,"change:audioUrl",this.refresh),this.listenTo(this.model,"destroy",this.cleanup)},render:function(){var a,b,c=this.model.toJSON(),d=this.$el.find(".mejs-audio").attr("id");return""===c.audioUrl&&d&&g.players[d].remove(),this.$el.html(this.template(this.model.toJSON())),a=this.$el.find(".cue-audio"),a.length&&(a.wrap("<body></body>"),b={features:["playpause","current","progress","duration"],pluginPath:h.pluginPath,success:f.bind(function(a,b,c){var d=e(c.container).parent();c.current.removeClass("mejs-time-current").addClass("cuemejs-time-current wp-ui-highlight"),e.nodeName(d.get(0),"body")&&d.replaceWith(d.get(0).childNodes)},this),error:function(a){var b=e(a),c=b.closest(".cue-track"),d=b.closest(".mejs-audio").attr("id");g.players[d].remove(),c.find("audio").remove()}},"m4a"===a.attr("src").split(".").pop()&&(b.pluginVars="isvideo=true"),a.mediaelementplayer(b)),this},refresh:function(a){var b=this.model.toJSON(),c=this.$el.find(".mejs-audio").attr("id"),d=c?g.players[c]:null;d&&""!==b.audioUrl?(d.pause(),d.setSrc(b.audioUrl)):this.render()},cleanup:function(){var a=this.$el.find(".mejs-audio").attr("id"),b=a?g.players[a]:null;b&&b.remove()},select:function(){i.setModel(this.model).get("selectAudio").open()}}),b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../modules/workflows":3,cue:"cue"}],cue:[function(a,b,c){(function(a){"use strict";function c(){var a={};d.extend(this,{controller:{},l10n:{},model:{},view:{}}),this.settings=function(b){return b&&d.extend(a,b),a.l10n&&(this.l10n=d.extend(this.l10n,a.l10n),delete a.l10n),a||{}}}var d="undefined"!=typeof window?window._:"undefined"!=typeof a?a._:null;a.cue=a.cue||new c,b.exports=a.cue}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[4]);